#
# lovelace configuration - one big file for all
#

title: !env_var HA_TITLE
views:

  - title: Sensorwerte
    path: values
    panel: true
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.dht22_lounge_pressure
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.ds18b20_pool_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: markdown
                content: <br/><br/><br/><br/><br/><br/><br/><br/>
              - type: sensor
                entity: sensor.rain_garden_precipitation_last7d
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.rain_garden_precipitation_last24h
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.rain_garden_precipitation
                graph: line
                detail: 2
                hours_to_show: 24
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.dht22_lounge_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_terrace_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_roof_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.relay_garage_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_office_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht11_utilityroom_temperature
                graph: line
                detail: 2
                hours_to_show: 24
          - type: horizontal-stack
            cards:
              - type: sensor
                icon: mdi:show_chart
                entity: sensor.dht22_lounge_humidity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_terrace_humidity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_roof_humidity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.relay_garage_humidity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_office_humidity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht11_utilityroom_humidity
                graph: line
                detail: 2
                hours_to_show: 24
          - type: horizontal-stack
            cards:
              - type: sensor
                icon: mdi:show_chart
                entity: sensor.dht22_lounge_tau
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_terrace_tau
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_roof_tau
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.relay_garage_tau
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht22_office_tau
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.dht11_utilityroom_tau
                graph: line
                detail: 2
                hours_to_show: 24
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.soil_garden_temperature1
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.soil_garden_temperature2
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.soil_garden_temperature3
                graph: line
                detail: 2
                hours_to_show: 24
              - type: markdown
                content: <br/><br/><br/><br/><br/><br/><br/><br/>
              - type: markdown
                content: <br/><br/><br/><br/><br/><br/><br/><br/>
              - type: markdown
                content: <br/><br/><br/><br/><br/><br/><br/><br/>
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.soil_garden_moisture1
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.soil_garden_moisture2
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.soil_garden_moisture3
                graph: line
                detail: 2
                hours_to_show: 24
              - type: markdown
                content: <br/><br/><br/><br/><br/><br/><br/><br/>
              - type: markdown
                content: <br/><br/><br/><br/><br/><br/><br/><br/>
              - type: markdown
                content: <br/><br/><br/><br/><br/><br/><br/><br/>

  - title: Pflanzen
    path: plants
    panel: true
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.goldfruchtpalme_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.goldfruchtpalme_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.goldfruchtpalme_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.goldfruchtpalme_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.goldfruchtpalme_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.birkenfeige_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.birkenfeige_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.birkenfeige_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.birkenfeige_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.birkenfeige_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.palmlilie_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.palmlilie_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.palmlilie_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.palmlilie_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.palmlilie_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.bogenhanf_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.bogenhanf_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.bogenhanf_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.bogenhanf_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.bogenhanf_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.korbmarante_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.korbmarante_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.korbmarante_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.korbmarante_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.korbmarante_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.fensterblatt_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.fensterblatt_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.fensterblatt_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.fensterblatt_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.fensterblatt_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.gummibaum_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.gummibaum_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.gummibaum_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.gummibaum_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.gummibaum_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
          - type: horizontal-stack
            cards:
              - type: sensor
                entity: sensor.fiederaralie_flowercare_moisture
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100
              - type: sensor
                entity: sensor.fiederaralie_flowercare_conductivity
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.fiederaralie_flowercare_brightness
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.fiederaralie_flowercare_temperature
                graph: line
                detail: 2
                hours_to_show: 24
              - type: sensor
                entity: sensor.fiederaralie_flowercare_battery
                graph: line
                detail: 2
                hours_to_show: 24
                limits:
                  min: 0
                  max: 100

  - title: Energie
    path: energy
    panel: false
    card_mod:
        # https://www.w3.org/wiki/CSS/Properties/color/keywords
        # for state-icon use --paper-item-icon-color
        # for state badge use --label-badge-text-color or --label-badge-background-color (the whole badge is then colorized)
        style: |
            ha-card {
                --battery-state-color: {{ state_attr ( 'binary_sensor.battery_state', 'icon_color' ) }}
            }
    badges:
      - entity: binary_sensor.pv_generating
        name: Erzeugung
      - entity: binary_sensor.battery_charging
        name: Laden
      - entity: binary_sensor.battery_state
        name: Batterie
        style:
          --label-badge-text-color: var(--battery-state-color)
      - entity: binary_sensor.battery_discharging
        name: Entladen
      - entity: binary_sensor.sh10rt_master_exporting_power
        name: Export
      - entity: binary_sensor.sh10rt_master_importing_power
        name: Import
    cards:
      - type: gauge
        name: Netzleistung
        entity: sensor.electricity_meter_power
        min: -5000
        max: +5000
        needle: true
        segments:
          - from: -5000
            color: '#ffa600'
          - from: 0
            color: '#3788d8'
      - type: entities
        title: Netz
        show_header_toggle: false
        entities:
          - type: section
            label: Bezug
          - entity: sensor.tasmota_lk13be_energy_total_in
            name: Zählerstand
            icon: mdi:counter
          - entity: sensor.electricity_meter_daily_in
            name: täglich
            icon: mdi:transmission-tower-import
          - entity: sensor.electricity_meter_yearly_in
            name: jährlich
            icon: mdi:transmission-tower-import
          - type: section
            label: Einspeisung
          - entity: sensor.tasmota_lk13be_energy_total_out
            name: Zählerstand
            icon: mdi:counter
          - entity: sensor.electricity_meter_daily_out
            name: täglich
            icon: mdi:transmission-tower-export
          - entity: sensor.electricity_meter_yearly_out
            name: jährlich
            icon: mdi:transmission-tower-export
      - type: gauge
        name: Solarleistung
        entity: sensor.total_dc_power
        min: 0
        max: 20000
        # needle: true
        severity:
            yellow: 0
            red: 20000
      - type: entities
        title: Solar
        show_header_toggle: false
        entities:
          - type: section
            label: Vorhersage
          - entity: sensor.estimated_energy_production_today
            name: heute
            icon: mdi:solar-power
          - entity: sensor.power_highest_peak_time_today
            name: Peak Gartenseite
            icon: mdi:summit
          - entity: sensor.power_highest_peak_time_today_2
            name: Peak Straßenseite
            icon: mdi:summit
          - type: section
            label: Produktion
          - entity: sensor.sh10rt_master_total_dc_power
            name: Gartenseite
            icon: mdi:solar-power-variant-outline
          - entity: sensor.sh10rt_slave_total_dc_power
            name: Straßenseite
            icon: mdi:solar-power-variant-outline
          - entity: sensor.solar_meter_daily
            name: täglich
            icon: mdi:solar-power
          - entity: sensor.solar_meter_yearly
            name: jährlich
            icon: mdi:solar-power
          - entity: sensor.daily_pv_generation
            name: tägich (Wechselrichter)
          - entity: sensor.sh10rt_master_daily_pv_generation
            name: tägich (Wechselrichter 1)
          - entity: sensor.sh10rt_slave_daily_pv_generation
            name: tägich (Wechselrichter 2)
          - entity: sensor.sh10rt_master_daily_imported_energy
            name: Import (Wechselrichter)
          - entity: sensor.sh10rt_master_daily_exported_energy_from_pv
            name: Export (Wechselrichter)
      - type: gauge
        name: Batterieladung
        entity: sensor.sh10rt_master_battery_level
        min: 0
        max: 100
        severity:
          green: 70
          yellow: 25
          red: 10
      - type: entities
        title: Batterie
        show_header_toggle: false
        entities:
          - entity: sensor.battery_power
          - type: section
            label: Entladung
          - entity: sensor.sh10rt_master_daily_battery_discharge
            name: täglich
            icon: mdi:battery-arrow-down
          - type: section
            label: Auftladung
          - entity: sensor.sh10rt_master_daily_battery_charge
            name: täglich
            icon: mdi:battery-arrow-up
          - entity: sensor.sh10rt_master_daily_battery_charge_from_pv
            name: täglich per Solar
            icon: mdi:battery-arrow-up
      - type: gauge
        name: Füllstand Gasspeicher Deutschland
        entity: sensor.gas_storage_germany_full_level
        min: 0
        max: 100
        needle: true
        segments:
          - from: 0
            color: '#db4437'
          - from: 40
            color: '#ffa600'
          - from: 80
            color: '#43a047'
      - type: entities
        title: Gasspeicher Deutschland
        show_header_toggle: false
        entities:
          - sensor.gas_storage_germany_day
          # - sensor.gas_storage_germany_full_level
          - sensor.gas_storage_germany_full_total
          - sensor.gas_storage_germany_trend
          - sensor.gas_storage_germany_storage_consumption_level
          - sensor.gas_storage_germany_consumption_total

  - title: Heizung
    path: heating
    panel: false
    basges:
      - binary_sensor.boiler_heatingactive
      - binary_sensor.boiler_tapwateractive
      - binary_sensor.boiler_burngas
      - binary_sensor.boiler_heatingpump
      - binary_sensor.boiler_wwcharging
      # - binary_sensor.boiler_wwactive
      - binary_sensor.boiler_ww3wayvalve
    cards:
      - type: entities
        title: Einstellungen
        show_header_toggle: false
        entities:
          - number.boiler_selflowtemp
          - number.boiler_heatingtemp
          - type: divider
          - number.boiler_wwseltemp
          - number.boiler_wwflowtempoffset
          - number.boiler_wwdisinfectiontemp
          - type: divider
          - number.thermostat_hc1_seltemp
          - number.thermostat_hc1_heattemp
          - number.thermostat_hc1_ecotemp
          # - select.thermostat_hc1_mode
          # - select.thermostat_hc1_roomsensor
          - type: divider
          - switch.boiler_wwonetime
          - switch.boiler_wwdisinfecting
      - type: entities
        title: Messwerte
        show_header_toggle: false
        entities:
          - sensor.boiler_outdoortemp
          - sensor.boiler_curflowtemp
          - sensor.boiler_rettemp
          - type: divider
          - sensor.boiler_syspress
          - sensor.boiler_curburnpow
          - sensor.boiler_heatingpumpmod
          - type: divider
          - sensor.boiler_wwsettemp
          - sensor.boiler_wwcurtemp
          # - sensor.boiler_wwcurflow
          # - sensor.boiler_wwchargetype

  - title: Solar
    path: solar
    panel: false
    cards:
      - type: entities
        title: Netz
        entities:
          - entity: sensor.sh10rt_master_export_power_raw
          - entity: sensor.electricity_meter_power
          - entity: sensor.import_power
          - entity: sensor.export_power
          - entity: sensor.sh10rt_master_load_power
          - type: divider
          - entity: sensor.sh10rt_master_phase_a_voltage
          - entity: sensor.sh10rt_master_phase_a_current
          - entity: sensor.sh10rt_master_phase_b_voltage
          - entity: sensor.sh10rt_master_phase_b_current
          - entity: sensor.sh10rt_master_phase_c_voltage
          - entity: sensor.sh10rt_master_phase_c_current
          - type: divider
          - entity: sensor.sh10rt_master_grid_frequency
      - type: entities
        title: Master
        entities:
          - type: section
            label: Zustand
          - entity: sensor.sh10rt_master_device_type
          - entity: sensor.sh10rt_master_inverter_state
          - entity: sensor.sh10rt_master_system_state
          - entity: sensor.sh10rt_master_running_state
          - entity: sensor.sh10rt_master_inverter_temperature
          - type: section
            label: Strings (1+4)
          - entity: sensor.sh10rt_master_mppt1_voltage
          - entity: sensor.sh10rt_master_mppt1_current
          - entity: sensor.sh10rt_master_mppt2_voltage
          - entity: sensor.sh10rt_master_mppt2_current
      - type: entities
        title: Slave
        entities:
          - type: section
            label: Zustand
          - entity: sensor.sh10rt_slave_device_type
          - entity: sensor.sh10rt_slave_inverter_state
          - entity: sensor.sh10rt_slave_system_state
          - entity: sensor.sh10rt_slave_running_state
          - entity: sensor.sh10rt_slave_inverter_temperature
          - type: section
            label: Strings (2+3)
          - entity: sensor.sh10rt_slave_mppt1_voltage
          - entity: sensor.sh10rt_slave_mppt1_current
          - entity: sensor.sh10rt_slave_mppt2_voltage
          - entity: sensor.sh10rt_slave_mppt2_current
      - type: entities
        title: Batterie
        entities:
          - type: section
            label: Zustand
          - entity: sensor.sh10rt_master_battery_level
          - entity: sensor.sh10rt_master_battery_state_of_health
          - entity: sensor.sh10rt_master_battery_temperature
          - type: section
            label: Werte
          - entity: sensor.sh10rt_master_battery_power_raw
          - entity: sensor.battery_charging_power
          - entity: sensor.battery_discharging_power
          - entity: sensor.sh10rt_master_battery_voltage
          - entity: sensor.sh10rt_master_battery_current
          # - type: section
            # label: SoC
          # - entity: sensor.sh10rt_master_max_soc
          # - entity: sensor.sh10rt_master_min_soc
      - type: statistics-graph
        title: Battery SoC last 60 days
        chart_type: line
        period: day
        days_to_show: 60
        entities:
          - sensor.battery_level
        stat_types:
          - min
          - max

  - title: MPPT
    path: mpptgraph
    type: panel
    cards:
      - type: history-graph
        hours_to_show: 24
        entities:
          - entity: sensor.sh10rt_master_mppt1_voltage
          - entity: sensor.sh10rt_master_mppt1_current
          - entity: sensor.sh10rt_master_mppt2_voltage
          - entity: sensor.sh10rt_master_mppt2_current
          - entity: sensor.sh10rt_slave_mppt1_voltage
          - entity: sensor.sh10rt_slave_mppt1_current
          - entity: sensor.sh10rt_slave_mppt2_voltage
          - entity: sensor.sh10rt_slave_mppt2_current

  # - title: Solar2
    # path: details
    # panel: false
    # cards:
      # - type: entities
        # title: Energy
        # entities:
          # - entity: sensor.daily_pv_generation
          # - entity: sensor.daily_direct_energy_consumption
          # - entity: sensor.daily_exported_energy_from_pv
          # - entity: sensor.daily_pv_generation_battery_discharge
          # - entity: sensor.daily_battery_charge_from_pv
          # - entity: sensor.daily_battery_discharge
          # - entity: sensor.daily_exported_energy
          # - entity: sensor.daily_battery_charge
          # - entity: sensor.daily_imported_energy
          # - entity: sensor.total_pv_generation
          # - entity: sensor.total_direct_energy_consumption
          # - entity: sensor.total_pv_generation_battery_discharge
          # - entity: sensor.total_exported_energy_from_pv
          # - entity: sensor.total_battery_charge_from_pv
          # - entity: sensor.total_battery_charge
          # - entity: sensor.total_battery_discharge
          # - entity: sensor.total_imported_energy
          # - entity: sensor.total_exported_energy
      # - type: entities
        # title: EMS
        # entities:
          # - entity: sensor.ems_mode_selection
          # - entity: sensor.battery_forced_charge_discharge_cmd
          # - entity: sensor.min_soc
          # - entity: sensor.max_soc
          # - entity: sensor.battery_forced_charge_discharge_power
          # - entity: sensor.battery_charging_start_power
          # - entity: sensor.battery_discharging_start_power

  - title: Diagramme
    path: heatinggraph
    type: panel
    cards:
      - type: history-graph
        hours_to_show: 24
        entities:
          - sensor.boiler_outdoortemp
          - number.boiler_selflowtemp
          - number.boiler_heatingtemp
          - sensor.boiler_curflowtemp
          - sensor.boiler_rettemp
          - number.boiler_wwseltemp
          - sensor.boiler_wwcurtemp
          # - sensor.boiler_syspress
          - binary_sensor.boiler_heatingpump
          - switch.sonoff_utilityroom_pump
          # - sensor.boiler_heatingpumpmod
          - sensor.boiler_curburnpow
          - sensor.total_dc_power
          - sensor.sh10rt_master_load_power
          - sensor.export_power
          - sensor.import_power
          - sensor.battery_power
          - sensor.electricity_meter_power