#
# lovelace configuration - one big file for all
#

title: !env_var HA_TITLE
views:

  - title: Überblick
    path: home
    panel: true
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              # https://community.home-assistant.io/t/styling-elements-in-picture-elements-card-a-small-tutorial/315252/5
              - type: picture-elements
                image: /local/images/blank_100x5.png
                title: Anwesenheiten
                card_mod:
                    # https://www.w3.org/wiki/CSS/Properties/color/keywords
                    # for state-icon use --paper-item-icon-color
                    # for state badge use --label-badge-text-color or --label-badge-background-color (the whole badge is then colorized)
                    style: |
                        ha-card {
                            --wasserampel-color: {{ state_attr ( 'binary_sensor.wasserampel', 'icon_color' ) }};
                            --grid-state-color: {{ state_attr ( 'binary_sensor.grid_state', 'icon_color' ) }};
                            --pv-generating-color: {{ state_attr ( 'binary_sensor.pv_generating', 'icon_color' ) }};
                            --battery-state-color: {{ state_attr ( 'binary_sensor.battery_state', 'icon_color' ) }};
                        }
                elements:
                  - type: state-badge
                    entity: device_tracker.156_andreas_pixel_6_pro_wlan
                    style:
                      top: 40%
                      left: 5%
                  - type: state-badge
                    entity: device_tracker.163_undine_z_flip4_wlan
                    style:
                      top: 40%
                      left: 9%
                  - type: state-badge
                    entity: device_tracker.galaxy_a52
                    style:
                      top: 40%
                      left: 13%
                  - type: state-badge
                    entity: device_tracker.161_nina_a52s_wlan
                    style:
                      top: 40%
                      left: 17%
                  - type: state-badge
                    entity: device_tracker.a52_von_niklas
                    style:
                      top: 40%
                      left: 21%
                  - type: state-badge
                    entity: device_tracker.140_dominik_xperia_wlan
                    style:
                      top: 40%
                      left: 25%
                  - type: state-badge
                    entity: binary_sensor.wasserampel
                    title: Wasserampel
                    style:
                      --label-badge-text-color: var(--wasserampel-color)
                      top: 40%
                      left: 36%
                  - type: state-badge
                    entity: sensor.rain_garden_precipitation_last7d
                    style:
                      top: 40%
                      left: 40%
                  - type: state-badge
                    entity: sensor.rain_garden_precipitation_last24h
                    style:
                      top: 40%
                      left: 44%
                  - type: state-badge
                    entity: sensor.rain_garden_precipitation
                    style:
                      top: 40%
                      left: 48%
                  - type: state-badge
                    entity: binary_sensor.grid_state
                    name: Netz
                    style:
                      --label-badge-text-color: var(--grid-state-color)
                      top: 40%
                      left: 54%
                  - type: state-badge
                    entity: binary_sensor.pv_generating
                    name: Solar
                    style:
                      --label-badge-text-color: var(--pv-generating-color)
                      top: 40%
                      left: 58%
                  - type: state-badge
                    entity: binary_sensor.battery_state
                    name: Baterie
                    style:
                      --label-badge-text-color: var(--battery-state-color)
                      top: 40%
                      left: 62%
                  - type: state-badge
                    entity: binary_sensor.eingangstur
                    style:
                      top: 40%
                      left: 68%
                  - type: state-badge
                    entity: binary_sensor.nebentur
                    style:
                      top: 40%
                      left: 72%
                  - type: state-badge
                    entity: binary_sensor.garagentur
                    style:
                      top: 40%
                      left: 76%
                  - type: state-badge
                    # entity: sensor.relay_garage_state
                    entity: binary_sensor.garagentor
                    style:
                      top: 40%
                      left: 80%
                  - type: state-badge
                    entity: sun.sun
                    style:
                      top: 40%
                      left: 86%
                  - type: state-badge
                    entity: sensor.ups_status
                    style:
                      top: 40%
                      left: 90%
                  - type: state-badge
                    entity: binary_sensor.gardena_smart_system_connection
                    style:
                      top: 40%
                      left: 94%
                  - type: state-badge
                    entity: sensor.cpu_temp
                    style:
                      top: 40%
                      left: 98%
          - type: horizontal-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: weather-forecast
                        name: Wettervorhersage
                        entity: weather.openweathermap
                  - type: horizontal-stack
                    cards:
                      - type: sensor
                        entity: sensor.dht22_terrace_temperature
                        graph: line
                        detail: 2
                        hours_to_show: 24
                      - type: sensor
                        icon: mdi:show_chart
                        entity: sensor.dht22_lounge_pressure
                        graph: line
                        detail: 2
                        hours_to_show: 24
                      - type: sensor
                        # entity: sensor.ds18b20_pool_temperature
                        entity: sensor.tileboard_temperature_template
                        graph: line
                        detail: 2
                        hours_to_show: 24
                      - type: sensor
                        entity: sensor.dht22_office_temperature
                        graph: line
                        detail: 2
                        hours_to_show: 24
                      - type: sensor
                        entity: sensor.dht11_utilityroom_temperature
                        graph: line
                        detail: 2
                        hours_to_show: 24
                  - type: horizontal-stack
                    cards:
                      - type: thermostat
                        entity: climate.office
                      - type: thermostat
                        entity: climate.bedroom
                      - type: thermostat
                        entity: climate.nursery
                  - type: horizontal-stack
                    cards:
                      - type: media-control
                        entity: media_player.sony_bravia_tv
                      - type: markdown
                        content: " "
              - type: vertical-stack
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: entity-button
                        entity: light.automatic_indoor_lights
                        tap_action:
                            action: toggle
                        hold_action:
                            action: more-info
                      - type: entity-button
                        entity: light.automatic_outdoor_lights
                        tap_action:
                            action: toggle
                        hold_action:
                            action: more-info
                  - type: horizontal-stack
                    cards:
                      - type: light
                        entity: light.led_kitchen_led
                      - type: light
                        entity: light.led_corridor_led
                      # - type: light
                        # entity: light.ws2812_terrace1
                      # - type: light
                        # entity: light.ws2812_terrace2
                      - type: light
                        entity: light.ws2812_xmasstar
                  - type: horizontal-stack
                    cards:
                      - type: button
                        entity: cover.rooflights
                        tap_action:
                            action: call-service
                            service: cover.stop_cover
                            data:
                                entity_id: cover.rooflights
                        double_tap_action:
                            action: toggle
                        hold_action:
                            action: more-info
                      - type: entity-button
                        entity: switch.sonoff_k8200_socket
                        icon: mdi:printer-3d
                      - type: entity-button
                        entity: switch.sonoff_pool_socket
                        icon: mdi:pump
                      # - type: markdown
                        # content: " "
                  - type: horizontal-stack
                    cards:
                      - type: entity-button
                        entity: switch.relay_garden_valve1
                        icon: mdi:watering-can
                      - type: entity-button
                        entity: switch.relay_garden_valve2
                        icon: mdi:watering-can
                      - type: entity-button
                        entity: switch.relay_garden_valve3
                        icon: mdi:watering-can

  - title: Innen
    path: indoor
    panel: false
    badges:
      - type: entity-filter
        entities:
          - entity: device_tracker.156_andreas_pixel_6_pro_wlan
          - entity: device_tracker.163_undine_z_flip4_wlan
          - entity: device_tracker.galaxy_a52
          - entity: device_tracker.161_nina_a52s_wlan
          - entity: device_tracker.a52_von_niklas
          - entity: device_tracker.140_dominik_xperia_wlan
        state_filter:
          - "home"
      - entity: sensor.bedroom_temperature
        name: Schlafzimmer
      - entity: sensor.office_temperature
        name: Büro
      - entity: sensor.nursery_temperature
        name: Kinderzimmer
      - type: entity-filter
        entities:
          - plant.goldfruchtpalme_flowercare
          - plant.birkenfeige_flowercare
          - plant.palmlilie_flowercare
          - plant.bogenhanf_flowercare
          - plant.korbmarante_flowercare
          - plant.fensterblatt_flowercare
          - plant.gummibaum_flowercare
          - plant.fliederaralie_flowercare
        state_filter:
          - "problem"
      - type: entity-filter
        entities:
          - binary_sensor.bewegungsmelder1
          - binary_sensor.smokedetectionsystem
          - binary_sensor.rauchwarnmelder_esszimmer
          - binary_sensor.rauchwarnmelder_wohnz
          - binary_sensor.rauchwarnmelder_flur
          - binary_sensor.rauchwarnmelder_hauswirt
          - binary_sensor.rauchwarnmelder_galerie
          - binary_sensor.rauchwarnmelder_schlafz
          - binary_sensor.rauchwarnmelder_buro
          - binary_sensor.rauchwarnmelder_kinderz
        state_filter:
          - "on"
    cards:
      - type: glance
        title: Erdgeschoss
        columns: 3
        entities:
          - light.rfhub_lounge_lampkitchenshortstrip
          - light.rfhub_lounge_lampkitchenlongstrip
          - light.led_kitchen_led
          - entity: light.relay_dining1_lamp
            name: Linker Schrank
          - entity: light.relay_dining2_lamp
            name: Rechter Schrank
          - light.rfhub_lounge_lamptree
          - light.rfhub_lounge_lightweb
          - light.ws2812_xmasstar
          # Xmas
          # - light.xmastreedining_leds
          - light.rfhub_lounge_lamploungewhiteball
          - light.rfhub_lounge_lamploungeblackbowl
          - light.rfhub_lounge_lamploungereading
          - light.rfhub_lounge_lampstudypillar
          - light.led_corridor_led
          - light.pitouch_corridor_screen
          # - sensor.pitouch_corridor_ambientlight
          - light.shelly_shower_socket
          - switch.sonoff_utilityroom_pump
          - entity: binary_sensor.rauchwarnmelder_esszimmer
            name: Esszimmer (Rauchwarnmelder)
          - entity: binary_sensor.rauchwarnmelder_wohnz
            name: Wohnzimmer (Rauchwarnmelder)
          - entity: binary_sensor.rauchwarnmelder_flur
            name: Flur (Rauchwarnmelder)
          - entity: binary_sensor.rauchwarnmelder_hauswirt
            name: Hauswirtschaftsraum (Rauchwarnmelder)
          - sensor.geschirrspuler_operation_state
          - binary_sensor.geschirrspuler_door
      - type: glance
        title: Obergeschoss
        columns: 3
        entities:
          - light.sonoff_gallery1_socket
          - light.sonoff_bedroom_socket
          - light.sonoff_corridor_lamp
          - light.shelly_bath_socket
          - switch.sonoff_k8200_socket
          # - sensor.bedroom_temperature
          # - sensor.office_temperature
          # - sensor.nursery_temperature
          - type: thermostat
            entity: climate.office
          - type: thermostat
            entity: climate.bedroom
          - type: thermostat
            entity: climate.nursery
          - entity: binary_sensor.rauchwarnmelder_galerie
            name:  Galerie (Rauchwarnmelder)
          - entity: binary_sensor.rauchwarnmelder_schlafz
            name:  Schlafzimmer (Rauchwarnmelder)
          - entity: binary_sensor.rauchwarnmelder_buro
            name:  Büro (Rauchwarnmelder)
          - entity: binary_sensor.rauchwarnmelder_kinderz
            name:  Kinderzimmer (Rauchwarnmelder)
      - type: glance
        title: Dachgeschoss
        columns: 3
        entities:
          - binary_sensor.dachboden
          - light.shelly_roof_socket
          - entity: binary_sensor.rauchwarnmelder_dachboden
            name: Dachgeschoss (Rauchwarnmelder)
      - type: vertical-stack
        cards:
          - type: plant-status
            name: Goldfruchtpalme - Dypsis lutescens
            link: https://www.mein-schoener-garten.de/pflanzen/goldfruchtpalme/goldfruchtpalme
            entity: plant.goldfruchtpalme_flowercare
          - type: plant-status
            name: Birkenfeige - Ficus benjamina
            link: https://www.mein-schoener-garten.de/pflanzen/feige/birkenfeige
            entity: plant.birkenfeige_flowercare
          - type: plant-status
            name: Riesen-Palmlilie - Yucca elephantipes
            link: https://www.mein-schoener-garten.de/pflanzen/palmlilie-yucca/yucca-palme
            entity: plant.palmlilie_flowercare
          - type: plant-status
            name: Bogenhanf - Sansevieria trifasciata
            link: https://www.mein-schoener-garten.de/pflanzen/bogenhanf-sansevieria
            entity: plant.bogenhanf_flowercare
          - type: plant-status
            name: Korbmarante - Calathea rufibarba
            link: https://www.mein-schoener-garten.de/pflanzen/korbmarante/calathea-rufibarba
            entity: plant.korbmarante_flowercare
          - type: plant-status
            name: Fensterblatt - Monstera deliciosa
            link: https://www.mein-schoener-garten.de/pflanzen/fensterblatt/monstera-fensterblatt
            entity: plant.fensterblatt_flowercare
          - type: plant-status
            name: Gummibaum - Ficus elastica
            link: https://www.mein-schoener-garten.de/pflanzen/feige/gummibaum
            entity: plant.gummibaum_flowercare
          - type: plant-status
            name: Fiederaralie - Polyscias
            link: https://www.mein-schoener-garten.de/pflanzen/fiederaralie/fiederaralie
            entity: plant.fiederaralie_flowercare
      # - type: vertical-stack
        # cards:
          # - type: thermostat
            # entity: climate.office
          # - type: thermostat
            # entity: climate.bedroom
          # - type: thermostat
            # entity: climate.nursery

  - title: Außen
    path: outdoor
    panel: false
    badges:
      - sensor.rain_garden_precipitation_last7d
      - sensor.rain_garden_precipitation_last24h
      - sensor.rain_garden_precipitation
      - counter.no_rain_days
      - counter.warm_days
      - sensor.dht22_terrace_temperature_max
      - type: entity-filter
        entities:
          - entity: binary_sensor.eingangstur
          - entity: binary_sensor.nebentur
          - entity: binary_sensor.garagentur
          - entity: binary_sensor.garagentor
          - entity: binary_sensor.terassentur_kuche
          - entity: binary_sensor.terassentur_esszimmer
          - entity: binary_sensor.terassentur_wohnzimmer
          - entity: binary_sensor.dachfenster_arbeitszimmer
          - entity: binary_sensor.dachfenster_kinderzimmer
          - entity: binary_sensor.dachfenster_schlafzimmer
          - entity: binary_sensor.dachfenster_bad
        state_filter:
          # on = open, off = closed
          - "on"
    cards:
      - type: glance
        title: Außenlichter
        columns: 3
        entities:
          - entity: light.shelly_terrace_lamp
            name: Terasse
          - entity: light.relay_backyard_lamp
            name: Hinterhof
          - entity: light.sonoff_garage_lamp
            name: Garage
          - entity: light.sonoff_yardgate_lamp
            name: Gartentor
          # - light.ws2812_terrace1
          # - light.ws2812_terrace2
          - entity: light.rfhub_lounge_schwibbogen1
            name: Schwibbogen 1
          - entity: light.rfhub_lounge_schwibbogen2
            name: Schwibbogen 2
          - entity: light.rfhub_lounge_star
            name: Stern
          - entity: light.rfhub_lounge_drops
            name: Tropfen
      - type: glance
        title: Garten
        columns: 3
        entities:
            - switch.relay_garden_valve1
            - switch.relay_garden_valve2
            - switch.relay_garden_valve3
            - sensor.soil_garden_temperature1
            - sensor.soil_garden_temperature2
            - sensor.soil_garden_temperature3
            - sensor.soil_garden_moisture1
            - sensor.soil_garden_moisture2
            - sensor.soil_garden_moisture3
            - switch.sonoff_pool_socket
            - entity: switch.wasserpumpe
              icon: mdi:water-pump
            - sensor.wasserpumpe_power
      - type: glance
        title: Garage
        columns: 3
        entities:
          - cover.relay_garage
          - sensor.relay_garage_state
          - binary_sensor.rauchwarnmelder_garage
      - type: glance
        title: Fenster
        columns: 3
        entities:
            - input_boolean.cover_closed_at_low_temp
            - binary_sensor.dachfenster_arbeitszimmer
            - binary_sensor.dachfenster_schlafzimmer
            - binary_sensor.dachfenster_bad
            - binary_sensor.dachfenster_kinderzimmer
            - cover.office
            - cover.bedroom
            - cover.bath
            - cover.nursery
      - type: glance
        title: Türen
        columns: 3
        entities:
            - binary_sensor.eingangstur
            - binary_sensor.nebentur
            - binary_sensor.garagentur
            - binary_sensor.garagentor
            - binary_sensor.terassentur_kuche
            - binary_sensor.terassentur_esszimmer
            - binary_sensor.terassentur_wohnzimmer
      - type: conditional
        conditions:
          - entity: sensor.ds18b20_pool_temperature
            state_not: unknown
        card:
            type: vertical-stack
            cards:
              - type: gauge
                name: Pooltemperatur
                entity: sensor.ds18b20_pool_temperature
                min: 15
                max: 30
                unit: °C
              - type: gauge
                name: Akkuspannung
                entity: sensor.ds18b20_pool_voltage
                min: 2.5
                max: 4.5
                unit: V
                severity:
                    green:  3.9
                    yellow: 3.2
                    red:    0.0
              - type: history-graph
                title: Temperaturen und Akkuspannung
                hours_to_show: 168 # one week
                refersh_interval: 1800 # 30 min
                entities:
                  - sensor.ds18b20_pool_temperature
                  - sensor.dht22_terrace_temperature
                  - sensor.ds18b20_pool_voltage
      - type: conditional
        conditions:
          - entity: vacuum.sileno
            state_not: unavailable
        card:
            type: vertical-stack
            cards:
              - type: picture-elements
                title: Rasenmäher
                image: '/local/images/mower.jpg'
                elements:
                  # central
                  - type: state-label
                    entity: vacuum.sileno
                    tap_action:
                      action: more-info
                    style:
                     top: 14%
                     right: 38%
                     color: rgb(255, 255, 255)
                     transform: translate(0%,-50%)
                     font-family: Trebuchet MS
                     font-size: 150%
                     font-weight: bold
                     border-color: rgb(34, 154, 210)
                     border-radius: 6px
                     background-color: '#cccccc'
                  - type: state-label
                    entity: vacuum.sileno
                    attribute: operating_hours
                    prefix: "Zeit: "
                    suffix: " h"
                    style:
                      top: 79%
                      left: 45%
                      color: '#84a6ba'
                      transform: translate(0%,-50%)
                      pointer-events: none
                      font-family: Trebuchet MS
                      font-size: 80%
                      font-weight: bold
                  # left
                  - type: state-label
                    entity: sensor.vacuum_operation
                    style:
                     top: 10%
                     left: 1%
                     color: rgb(255, 255, 255)
                     transform: translate(0%,-50%)
                     pointer-events: none
                     font-family: Trebuchet MS
                     font-size: 90%
                     font-weight: bold
                     border-color: rgb(34, 154, 210)
                     background-color: '#3090C7'
                     border-radius: 6px
                  - type: state-label
                    entity: vacuum.sileno
                    attribute: activity
                    prefix: "Status: "
                    style:
                      top: 40%
                      left: 1%
                      color: '#ffffff'
                      transform: translate(0%,-50%)
                      pointer-events: none
                      font-family: Trebuchet MS
                      font-size: 80%
                      font-weight: bold
                      border-left-style: solid
                      border-color: '#3090C7'
                  - type: state-label
                    entity: sensor.sileno_battery_level
                    prefix: "Batterie: "
                    style:
                      top: 50%
                      left: 1%
                      color: '#ffffff'
                      transform: translate(0%,-50%)
                      pointer-events: none
                      font-family: Trebuchet MS
                      font-size: 80%
                      font-weight: bold
                      border-left-style: solid
                      border-color: rgb(34, 154, 210)
                  - type: state-label
                    entity: vacuum.sileno
                    attribute: error
                    prefix: "Fehler: "
                    style:
                      top: 60%
                      left: 1%
                      color: '#ffffff'
                      transform: translate(0%,-50%)
                      pointer-events: none
                      font-family: Trebuchet MS
                      font-size: 80%
                      font-weight: bold
                      border-left-style: solid
                      border-color: rgb(34, 154, 210)
                  - type: state-label
                    entity: vacuum.sileno
                    attribute: last_error
                    prefix: "Meldung: "
                    style:
                      top: 70%
                      left: 1%
                      color: '#ffffff'
                      transform: translate(0%,-50%)
                      pointer-events: none
                      font-family: Trebuchet MS
                      font-size: 80%
                      font-weight: bold
                      border-left-style: solid
                      border-color: rgb(34, 154, 210)
                  # bottom
                  - type: icon
                    icon: mdi:play
                    tap_action:
                      action: call-service
                      service: vacuum.start
                      service_data:
                          entity_id: vacuum.sileno
                    style:
                     top: 90%
                     left: 35%
                     color: '#3090C7'
                  - type: icon
                    icon: mdi:stop
                    tap_action:
                      action: call-service
                      service: vacuum.stop
                      service_data:
                          entity_id: vacuum.sileno
                    style:
                     top: 90%
                     left: 50%
                     color: '#3090C7'
                  - type: icon
                    icon: mdi:home
                    tap_action:
                      action: call-service
                      service: vacuum.return_to_base
                      service_data:
                          entity_id: vacuum.sileno
                    style:
                     top: 90%
                     left: 65%
                     color: '#3090C7'
                  # right
                  - type: state-label
                    entity: vacuum.sileno
                    attribute: rf_link_state
                    #prefix: "Netzwerk: "
                    style:
                     top: 10%
                     right: 1%
                     color: rgb(255, 255, 255)
                     transform: translate(0%,-50%)
                     pointer-events: none
                     font-family: Trebuchet MS
                     font-size: 90%
                     font-weight: bold
                     border-color: rgb(34, 154, 210)
                     background-color: '#3090C7'
                     border-radius: 6px
                  - type: state-label
                    entity: vacuum.sileno
                    attribute: rf_link_level
                    prefix: "Level: "
                    style:
                      top: 40%
                      right: 1%
                      color: '#ffffff'
                      transform: translate(0%,-50%)
                      pointer-events: none
                      font-family: Trebuchet MS
                      font-size: 76%
                      font-weight: bold
                      border-right-style: solid
                      border-color: rgb(34, 154, 210)
              - type: entities
                entities:
                - entity: sensor.sileno_battery_level

  - title: Energie
    path: energy
    panel: false
    badges:
      - entity: binary_sensor.grid_state
        name: Netz
        style: |
            :host {
                --label-badge-text-color: {{ state_attr ( 'binary_sensor.grid_state', 'icon_color' ) }}
            }
      - entity: binary_sensor.pv_generating
        name: Solar
        style: |
            :host {
                --label-badge-text-color: {{ state_attr ( 'binary_sensor.pv_generating', 'icon_color' ) }}
            }
      - entity: binary_sensor.battery_state
        name: Batterie
        # https://community.home-assistant.io/t/how-to-customize-the-badges-at-the-top-of-the-page/183152/11
        style: |
            :host {
                --label-badge-text-color: {{ state_attr ( 'binary_sensor.battery_state', 'icon_color' ) }}
            }
    cards:
      - type: vertical-stack
        cards:
          - type: gauge
            name: Netzleistung
            entity: sensor.electricity_meter_power
            min: -5000
            max: +5000
            needle: true
            segments:
              - from: -5000
                color: '#ffa600'
              - from: 0
                color: '#3788d8'
          - type: entities
            title: Netz
            show_header_toggle: false
            entities:
              - type: section
                label: Bezug
              - entity: sensor.tasmota_lk13be_energy_total_in
                name: Zählerstand
                icon: mdi:counter
              - entity: sensor.electricity_meter_daily_in
                name: täglich
                icon: mdi:transmission-tower-export
              - entity: sensor.electricity_meter_yearly_in
                name: jährlich
                icon: mdi:transmission-tower-export
              - type: section
                label: Einspeisung
              - entity: sensor.tasmota_lk13be_energy_total_out
                name: Zählerstand
                icon: mdi:counter
              - entity: sensor.electricity_meter_daily_out
                name: täglich
                icon: mdi:transmission-tower-import
              - entity: sensor.electricity_meter_yearly_out
                name: jährlich
                icon: mdi:transmission-tower-import
              - type: section
                label: Kosten
              - entity: sensor.electricity_daily_in_costs
                name: täglich
              - entity: sensor.electricity_yearly_in_costs
                name: jährlich
              - type: section
                label: Erlöse
              - entity: sensor.electricity_daily_out_returns
                name: täglich
              - entity: sensor.electricity_yearly_out_returns
                name: jährlich
      - type: vertical-stack
        cards:
          - type: gauge
            name: Hauslast
            entity: sensor.load_power
            min: 0
            max: +5000
            # needle: true
            severity:
              green: 0
              yellow: 1000
              red: 4000
          - type: entities
            title: Haus
            show_header_toggle: false
            entities:
              - type: section
                label: Verbrauch
              - sensor.daily_load
              - entity: sensor.load_meter_daily
                name: täglich
                icon: mdi:home-lightning-bolt-outline
              - entity: sensor.load_meter_yearly
                name: jährlich
                icon: mdi:home-lightning-bolt-outline
          # - type: energy-usage-graph
          - type: energy-distribution
          # - type: energy-solar-graph
          # - type: entities
            # title: Debug
            # show_header_toggle: false
            # entities:
              # - sensor.load_quarterhourly
              # - sensor.electricity_quarterhourly_in
              # - sensor.electricity_quarterhourly_out
              # - sensor.solar_quarterhourly
              # - sensor.battery_quarterhourly_in
              # - sensor.battery_quarterhourly_out
      - type: vertical-stack
        cards:
          - type: gauge
            name: Solarleistung
            entity: sensor.total_dc_power
            min: 0
            max: 20000
            # needle: true
            severity:
                yellow: 0
                red: 20000
          - type: entities
            title: Solar
            show_header_toggle: false
            entities:
              - entity: sensor.sh10rt_master_total_dc_power
                name: Gartenseite
                icon: mdi:solar-power-variant-outline
              - entity: sensor.sh10rt_slave_total_dc_power
                name: Straßenseite
                icon: mdi:solar-power-variant-outline
              - type: section
                label: Vorhersage
              - entity: sensor.estimated_energy_production_today
                name: heute
                icon: mdi:solar-power
              - entity: sensor.power_highest_peak_time_today
                name: Peak Gartenseite
                icon: mdi:summit
              - entity: sensor.power_highest_peak_time_today_2
                name: Peak Straßenseite
                icon: mdi:summit
              - type: section
                label: Produktion
              - entity: sensor.solar_meter_daily
                name: täglich
                icon: mdi:solar-power
              - entity: sensor.solar_meter_yearly
                name: jährlich
                icon: mdi:solar-power
      - type: vertical-stack
        cards:
          - type: gauge
            name: Batterieleistung
            entity: sensor.battery_power
            min: -5000
            max: +5000
            needle: true
            segments:
              - from: -5000
                color: '#ffa600'
              - from: 0
                color: '#3788d8'
          - type: gauge
            name: Batteriefüllung
            entity: sensor.sh10rt_master_battery_level
            min: 0
            max: 100
            severity:
              green: 70
              yellow: 25
              red: 10
          - type: entities
            title: Batterie
            show_header_toggle: false
            entities:
              # - entity: sensor.battery_power
                # name: Leistung
                # icon: mdi:home-battery-outline
              - type: section
                label: Entladung
              # - entity: sensor.sh10rt_master_daily_battery_discharge
                # name: täglich (Inverter)
                # icon: mdi:battery-arrow-down
              - entity: sensor.battery_meter_daily_out
                name: täglich
                icon: mdi:battery-arrow-down
              - entity: sensor.battery_meter_yearly_out
                name: jährlich
                icon: mdi:battery-arrow-down
              - type: section
                label: Auftladung
              # - entity: sensor.sh10rt_master_daily_battery_charge
                # name: täglich (Inverter)
                # icon: mdi:battery-arrow-up
              - entity: sensor.battery_meter_daily_in
                name: täglich
                icon: mdi:battery-arrow-down
              - entity: sensor.battery_meter_yearly_in
                name: jährlich
                icon: mdi:battery-arrow-down
              - type: section
                label: Ströme
              - entity: sensor.battery_current
                name: aktuell
              - entity: sensor.sh10rt_master_bms_max_charging_current
                name: maximaler Ladestrom
              - entity: sensor.sh10rt_master_bms_max_discharging_current
                name: maximaler Entladestrom
              - type: section
                label: State of Charge
              - entity: sensor.sh10rt_master_max_soc
                name: maximal
              - entity: sensor.sh10rt_master_min_soc
                name: minimal
              - entity: sensor.sh10rt_master_reserved_soc_for_backup
                name: Reserve für Backup

    # https://github.com/PiotrMachowski/lovelace-xiaomi-vacuum-map-card#tile-list-entry-options
  - title: Staubsauger
    path: vacuum
    panel: false
    cards:
      - type: custom:xiaomi-vacuum-map-card
        title: Erdgeschoss
        preset_name: live map ground floor
        entity: vacuum.roborock_s6_ground_floor
        vacuum_platform: default
        map_source:
            camera: camera.roborock_s6_ground_floor
        calibration_source:
            camera: true
        map_modes:
          - template: vacuum_clean_zone
          - template: vacuum_goto
          - template: vacuum_follow_path
      - type: custom:xiaomi-vacuum-map-card
        title: Obergeschoss
        preset_name: live map first floor
        entity: vacuum.roborock_s6_first_floor
        vacuum_platform: default
        map_source:
            camera: camera.roborock_s6_first_floor
        calibration_source:
            camera: true
        map_modes:
          - template: vacuum_clean_zone
          - template: vacuum_goto
          - template: vacuum_follow_path

