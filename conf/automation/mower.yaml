###
### 13.03.2021 new
###

  - alias: mower_start
    id: mower_start
    trigger:
      - platform: time
        at: input_datetime.mowing_start
    condition:
        # check stage
      - condition: state
        entity_id: binary_sensor.prod_mode
        state: 'on'
        # check manual flag
      - condition: state
        entity_id: input_boolean.mowing_activated
        state: 'on'
      - condition: template
        value_template: >
            {% set day = now().weekday() %}
            {{
               day == 0 and states ( 'input_boolean.mowing_at_monday' )    == 'on' or
               day == 1 and states ( 'input_boolean.mowing_at_tuesday' )   == 'on' or
               day == 2 and states ( 'input_boolean.mowing_at_wednesday' ) == 'on' or
               day == 3 and states ( 'input_boolean.mowing_at_thursday' )  == 'on' or
               day == 4 and states ( 'input_boolean.mowing_at_friday' )    == 'on' or
               day == 5 and states ( 'input_boolean.mowing_at_saturday' )  == 'on' or
               day == 6 and states ( 'input_boolean.mowing_at_sunday' )    == 'on'
            }}
    action:
      - service: vacuum.start
        entity_id: vacuum.sileno

  - alias: mower_end
    id: mower_end
    trigger:
      - platform: time
        at: input_datetime.mowing_end
    action:
      - service: vacuum.stop
        entity_id: vacuum.sileno
