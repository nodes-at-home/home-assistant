###
### sensor.yaml
###
### 04.11.2016 split up
###

#------------------------------------------------------------------------------
  - platform: yr

#------------------------------------------------------------------------------
  - platform: openweathermap
    api_key: !secret api_key_openweather
    forecast: 1
    monitored_conditions:
    - weather
    - temperature
    - humidity
    - pressure

#------------------------------------------------------------------------------
  - platform: systemmonitor
    resources:
      - type: disk_use_percent
        arg: /
      - type: memory_use_percent
      - type: processor_use
      - type: last_boot

#------------------------------------------------------------------------------
  # - platform: cpuspeed
    # name: "CPU"

  - platform: speedtest
    name: "Speedtest"
    minute:
        - 0
        - 30
    monitored_conditions:
        - ping
        - download
        - upload

#------------------------------------------------------------------------------
  # - platform: octoprint
    # name: OctoPrint
    # monitored_conditions:
      # - Temperatures
      # - Current State
      # - Job Percentage

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/terrace/value/temperature
    name: "DHT11@terrace_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/terrace/value/humidity
    name: "DHT11@terrace_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/terrace/value/voltage
    name: "DHT11@terrace_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'
    # unit_of_measurement: "mV"
    # value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/terrace/value/voltage
    name: "DHT11@terrace_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/terrace
    name: "DHT11@terrace_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/terrace
    name: "DHT11@terrace_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/terrace
    name: "DHT11@terrace_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/roof/value/temperature
    name: "DHT11@roof_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/roof/value/humidity
    name: "DHT11@roof_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/roof/value/voltage
    name: "DHT11@roof_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/roof/value/voltage
    name: "DHT11@roof_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/roof
    name: "DHT11@roof_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/roof
    name: "DHT11@roof_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/roof
    name: "DHT11@roof_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge/value/temperature
    name: "DHT11@lounge_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge/value/humidity
    name: "DHT11@lounge_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge/value/pressure
    name: "DHT11@lounge_pressure"
    qos: 0
    unit_of_measurement: "hPa"
    # value_template: '{{ value_json.value | round ( 0 ) }}'
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge/value/voltage
    name: "DHT11@lounge_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge/value/voltage
    name: "DHT11@lounge_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge
    name: "DHT11@lounge_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge
    name: "DHT11@lounge_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/lounge
    name: "DHT11@lounge_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom
    name: "sonoff@utilityroom_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom
    name: "sonoff@utilityroom_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom
    name: "sonoff@utilityroom_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom/value/voltage
    name: "sonoff@utilityroom_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom/value/voltage
    name: "sonoff@utilityroom_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage
    name: "sonoff@garage_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage
    name: "sonoff@garage_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage
    name: "sonoff@garage_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage/value/voltage
    name: "sonoff@garage_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage/value/voltage
    name: "sonoff@garage_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/relay1/dining
    name: "relay1@dining_hello"
    qos: 0
    # value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay1/dining
    name: "relay1@dining_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay1/dining
    name: "relay1@dining_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay1/dining/value/voltage
    name: "relay1@dining_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay1/dining/value/voltage
    name: "relay1@dining_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard
    name: "relay@backyard_hello"
    qos: 0
    # value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard
    name: "relay@backyard_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard
    name: "relay@backyard_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard/value/voltage
    name: "relay@backyard_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard/value/voltage
    name: "relay@backyard_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/relay2/dining
    name: "relay2@dining_hello"
    qos: 0
    # value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay2/dining
    name: "relay2@dining_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay2/dining
    name: "relay2@dining_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay2/dining/value/voltage
    name: "relay2@dining_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay2/dining/value/voltage
    name: "relay2@dining_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/first
    name: "rfhub@first_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/first
    name: "rfhub@first_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/first
    name: "rfhub@first_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/first/value/voltage
    name: "rfhub@first_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/first/value/voltage
    name: "rfhub@first_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/temperature
    name: "relay@garage_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/humidity
    name: "relay@garage_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/voltage
    name: "relay@garage_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/voltage
    name: "relay@garage_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage
    name: "relay@garage_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage
    name: "relay@garage_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage
    name: "relay@garage_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    name: "relay@garage_state"
    state_topic: nodes@home/cover/relay/garage/value/position

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining
    name: "xmastree@dining_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining
    name: "xmastree@dining_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining
    name: "xmastree@dining_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining/value/voltage
    name: "xmastree@dining_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining/value/voltage
    name: "xmastree@dining_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'
#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor
    name: "button@indoor_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor
    name: "button@indoor_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor
    name: "button@indoor_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor/value/voltage
    name: "button@indoor_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor/value/voltage
    name: "button@indoor_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage
    name: "button@garage_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage
    name: "button@garage_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage
    name: "button@garage_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage/value/voltage
    name: "button@garage_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage/value/voltage
    name: "button@garage_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool
    name: "button@pool_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool
    name: "button@pool_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool
    name: "button@pool_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool/value/voltage
    name: "button@pool_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool/value/voltage
    name: "button@pool_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen
    name: "pixel@kitchen_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen
    name: "pixel@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen
    name: "pixel@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen/value/voltage
    name: "pixel@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen/value/voltage
    name: "pixel@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/brewery
    name: "sonoff@brewery_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/brewery
    name: "sonoff@brewery_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/brewery
    name: "sonoff@brewery_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/brewery/value/voltage
    name: "sonoff@brewery_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/brewery/value/voltage
    name: "sonoff@brewery_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location2
    name: "sonoff@location2_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location2
    name: "sonoff@location2_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location2
    name: "sonoff@location2_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location2/value/voltage
    name: "sonoff@location2_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location2/value/voltage
    name: "sonoff@location2_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace
    name: "sonoff@terrace_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace
    name: "sonoff@terrace_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace
    name: "sonoff@terrace_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace/value/voltage
    name: "sonoff@terrace_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace/value/voltage
    name: "sonoff@terrace_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/test/value/temperature
    name: "DHT11@test_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/test/value/humidity
    name: "DHT11@test_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/test
    name: "DHT11@test_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/test
    name: "DHT11@test_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/test
    name: "DHT11@test_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/test/value/voltage
    name: "DHT11@test_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT11/test/value/voltage
    name: "DHT11@test_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate
    name: "sonoff@yardgate_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate
    name: "sonoff@yardgate_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate
    name: "sonoff@yardgate_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate/value/voltage
    name: "sonoff@yardgate_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate/value/voltage
    name: "sonoff@yardgate_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location3
    name: "sonoff@location3_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location3
    name: "sonoff@location3_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location3
    name: "sonoff@location3_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location3/value/voltage
    name: "sonoff@location3_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location3/value/voltage
    name: "sonoff@location3_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4
    name: "sonoff@location4_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4
    name: "sonoff@location4_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4
    name: "sonoff@location4_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4/value/voltage
    name: "sonoff@location4_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4/value/voltage
    name: "sonoff@location4_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen
    name: "sonoff@kitchen_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen
    name: "sonoff@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen
    name: "sonoff@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen/value/voltage
    name: "sonoff@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen/value/voltage
    name: "sonoff@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool/value/temperature
    name: "ds18b20@pool_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool/value/voltage
    name: "ds18b20@pool_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool/value/voltage
    name: "ds18b20@pool_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool
    name: "ds18b20@pool_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool
    name: "ds18b20@pool_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool
    name: "ds18b20@pool_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery/value/temperature
    name: "ds18b20@brewery_brew_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.brew | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery/value/temperature
    name: "ds18b20@brewery_outer_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.outer | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery/value/voltage
    name: "ds18b20@brewery_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery/value/voltage
    name: "ds18b20@brewery_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery
    name: "ds18b20@brewery_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery
    name: "ds18b20@brewery_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery
    name: "ds18b20@brewery_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/fermenter/value/temperature
    name: "ds18b20@fermenter_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/fermenter/value/voltage
    name: "ds18b20@fermenter_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/fermenter/value/voltage
    name: "ds18b20@fermenter_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/fermenter
    name: "ds18b20@fermenter_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/fermenter
    name: "ds18b20@fermenter_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/fermenter
    name: "ds18b20@fermenter_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen/value/voltage
    name: "oled@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen/value/voltage
    name: "oled@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen
    name: "oled@kitchen_hello"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }} - {{ value }}'

  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen
    name: "oled@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen
    name: "oled@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen
    name: "gesture@kitchen_hello"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen
    name: "gesture@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen
    name: "gesture@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen/value/voltage
    name: "gesture@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen/value/voltage
    name: "gesture@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------

  # https://community.home-assistant.io/t/recorder-purge-function/17154/11
  - platform: command_line
    name: log_db_file_size
    command: "du -m /home/homeassistant/.homeassistant/home-assistant_v2.db | cut -f1"
    unit_of_measurement: 'MB'
    value_template: '{{ value | int - 1 }}'