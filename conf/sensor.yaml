###
### sensor.yaml
###
### 04.11.2016 split up
###

#------------------------------------------------------------------------------
  - platform: yr

#------------------------------------------------------------------------------
  - platform: openweathermap
    api_key: !secret api_key_openweather
    forecast: 1
    monitored_conditions:
    - weather
    - temperature
    - humidity
    - pressure

#------------------------------------------------------------------------------
  - platform: systemmonitor
    resources:
      - type: disk_use
        arg: /
      - type: disk_use_percent
        arg: /
      - type: memory_use
      - type: memory_use_percent
      - type: processor_use
      - type: last_boot

#------------------------------------------------------------------------------
  # - platform: cpuspeed
    # name: "CPU"

  - platform: speedtest
    name: "Speedtest"
    minute:
        - 0
        - 30
    monitored_conditions:
        - ping
        - download
        - upload

#------------------------------------------------------------------------------
  # - platform: octoprint
    # name: OctoPrint
    # monitored_conditions:
      # - Temperatures
      # - Current State
      # - Job Percentage

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/terrace/value/temperature
    name: "DHT22@terrace_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/terrace/value/humidity
    name: "DHT22@terrace_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/terrace/value/voltage
    name: "DHT22@terrace_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'
    # unit_of_measurement: "mV"
    # value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/terrace/value/voltage
    name: "DHT22@terrace_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/terrace
    name: "DHT22@terrace_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/terrace
    name: "DHT22@terrace_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/roof/value/temperature
    name: "DHT22@roof_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/roof/value/humidity
    name: "DHT22@roof_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/roof/value/voltage
    name: "DHT22@roof_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/roof/value/voltage
    name: "DHT22@roof_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/roof
    name: "DHT22@roof_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/roof
    name: "DHT22@roof_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/lounge/value/temperature
    name: "DHT22@lounge_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/lounge/value/humidity
    name: "DHT22@lounge_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/lounge/value/pressure
    name: "DHT22@lounge_pressure"
    qos: 0
    unit_of_measurement: "hPa"
    # value_template: '{{ value_json.value | round ( 0 ) }}'
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/lounge/value/voltage
    name: "DHT22@lounge_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/lounge/value/voltage
    name: "DHT22@lounge_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/lounge
    name: "DHT22@lounge_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/DHT22/lounge
    name: "DHT22@lounge_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom
    name: "sonoff@utilityroom_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom
    name: "sonoff@utilityroom_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom/value/voltage
    name: "sonoff@utilityroom_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/utilityroom/value/voltage
    name: "sonoff@utilityroom_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage
    name: "sonoff@garage_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage
    name: "sonoff@garage_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage/value/voltage
    name: "sonoff@garage_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/garage/value/voltage
    name: "sonoff@garage_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining1
    name: "relay@dining1_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining1
    name: "relay@dining1_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining1/value/voltage
    name: "relay@dining1_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining1/value/voltage
    name: "relay@dining1_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard
    name: "relay@backyard_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard
    name: "relay@backyard_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard/value/voltage
    name: "relay@backyard_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/backyard/value/voltage
    name: "relay@backyard_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining2
    name: "relay@dining2_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining2
    name: "relay@dining2_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining2/value/voltage
    name: "relay@dining2_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/relay/dining2/value/voltage
    name: "relay@dining2_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/lounge
    name: "rfhub@lounge_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/lounge
    name: "rfhub@lounge_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/lounge/value/voltage
    name: "rfhub@lounge_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/rfhub/lounge/value/voltage
    name: "rfhub@lounge_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/temperature
    name: "relay@garage_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/humidity
    name: "relay@garage_humidity"
    qos: 0
    unit_of_measurement: "%"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/voltage
    name: "relay@garage_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage/value/voltage
    name: "relay@garage_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage
    name: "relay@garage_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/cover/relay/garage
    name: "relay@garage_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    name: "relay@garage_state"
    state_topic: nodes@home/cover/relay/garage/value/position

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining
    name: "xmastree@dining_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining
    name: "xmastree@dining_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining/value/voltage
    name: "xmastree@dining_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/xmastree/dining/value/voltage
    name: "xmastree@dining_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'
#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor
    name: "button@indoor_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor
    name: "button@indoor_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor/value/voltage
    name: "button@indoor_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/indoor/value/voltage
    name: "button@indoor_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage
    name: "button@garage_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage
    name: "button@garage_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage/value/voltage
    name: "button@garage_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/garage/value/voltage
    name: "button@garage_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool
    name: "button@pool_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool
    name: "button@pool_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool/value/voltage
    name: "button@pool_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/button/pool/value/voltage
    name: "button@pool_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen
    name: "pixel@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen
    name: "pixel@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen/value/voltage
    name: "pixel@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/pixel/kitchen/value/voltage
    name: "pixel@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/pool
    name: "sonoff@pool_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/pool
    name: "sonoff@pool_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/pool/value/voltage
    name: "sonoff@pool_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/pool/value/voltage
    name: "sonoff@pool_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/bedroom
    name: "sonoff@bedroom_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/bedroom
    name: "sonoff@bedroom_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/bedroom/value/voltage
    name: "sonoff@bedroom_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/bedroom/value/voltage
    name: "sonoff@bedroom_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace
    name: "sonoff@terrace_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace
    name: "sonoff@terrace_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace/value/voltage
    name: "sonoff@terrace_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/terrace/value/voltage
    name: "sonoff@terrace_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate
    name: "sonoff@yardgate_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate
    name: "sonoff@yardgate_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate/value/voltage
    name: "sonoff@yardgate_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/yardgate/value/voltage
    name: "sonoff@yardgate_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/gallery
    name: "sonoff@gallery_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/gallery
    name: "sonoff@gallery_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/gallery/value/voltage
    name: "sonoff@gallery_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/gallery/value/voltage
    name: "sonoff@gallery_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4
    name: "sonoff@location4_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4
    name: "sonoff@location4_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4/value/voltage
    name: "sonoff@location4_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location4/value/voltage
    name: "sonoff@location4_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/k8200
    name: "sonoff@k8200_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/k8200
    name: "sonoff@k8200_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/k8200/value/voltage
    name: "sonoff@k8200_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/k8200/value/voltage
    name: "sonoff@k8200_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/xmastree
    name: "sonoff@xmastree_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/xmastree
    name: "sonoff@xmastree_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/xmastree/value/voltage
    name: "sonoff@xmastree_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/xmastree/value/voltage
    name: "sonoff@xmastree_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location1
    name: "sonoff@location1_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location1
    name: "sonoff@location1_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location1/value/voltage
    name: "sonoff@location1_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/switch/sonoff/location1/value/voltage
    name: "sonoff@location1_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen
    name: "sonoff@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen
    name: "sonoff@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen/value/voltage
    name: "sonoff@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/sonoff/kitchen/value/voltage
    name: "sonoff@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool/value/temperature
    name: "ds18b20@pool_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool/value/voltage
    name: "ds18b20@pool_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool/value/voltage
    name: "ds18b20@pool_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool
    name: "ds18b20@pool_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/pool
    name: "ds18b20@pool_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery/value/temperature
    name: "ds18b20@brewery_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery/value/voltage
    name: "ds18b20@brewery_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery/value/voltage
    name: "ds18b20@brewery_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery
    name: "ds18b20@brewery_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ds18b20/brewery
    name: "ds18b20@brewery_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen/value/voltage
    name: "oled@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen/value/voltage
    name: "oled@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen
    name: "oled@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/display/oled/kitchen
    name: "oled@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen
    name: "gesture@kitchen_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen
    name: "gesture@kitchen_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen/value/voltage
    name: "gesture@kitchen_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/gesture/kitchen/value/voltage
    name: "gesture@kitchen_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/spindle/fermenter/value/temperature
    name: "spindle@fermenter_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/spindle/fermenter/value/tilt
    name: "spindle@fermenter_tilt"
    qos: 0
    unit_of_measurement: "°"
    value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/spindle/fermenter
    name: "spindle@fermenter_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/spindle/fermenter
    name: "spindle@fermenter_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/spindle/fermenter/value/voltage
    name: "spindle@fermenter_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/spindle/fermenter/value/voltage
    name: "spindle@fermenter_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/control/ssr/brewery/value/temperature
    name: "ssr@brewery_temperature"
    qos: 0
    unit_of_measurement: "°C"
    value_template: '{{ value_json.value | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/control/ssr/brewery
    name: "ssr@brewery_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/control/ssr/brewery
    name: "ssr@brewery_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/control/ssr/brewery/value/voltage
    name: "ssr@brewery_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/control/ssr/brewery/value/voltage
    name: "ssr@brewery_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/meter/electricity/utilityroom/value/power
    name: "electricity@utilityroom_power"
    qos: 0
    unit_of_measurement: "W"
    value_template: '{{ value_json.power | round ( 0 ) }}'

  - platform: mqtt
    state_topic: nodes@home/meter/electricity/utilityroom/value/counter
    name: "electricity@utilityroom_counter"
    qos: 0
    unit_of_measurement: "kWh"
    value_template: '{{ value_json.electricity | multiply  ( 0.001 ) | round ( 0 ) }}'

  - platform: mqtt
    state_topic: nodes@home/meter/electricity/utilityroom
    name: "electricity@utilityroom_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/meter/electricity/utilityroom
    name: "electricity@utilityroom_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/meter/electricity/utilityroom/value/voltage
    name: "electricity@utilityroom_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'

  - platform: mqtt
    state_topic: nodes@home/meter/electricity/utilityroom/value/voltage
    name: "electricity@utilityroom_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace1/value/voltage
    name: "ws2812@terrace1_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'
    # unit_of_measurement: "mV"
    # value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace1/value/voltage
    name: "ws2812@terrace1_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace1
    name: "ws2812@terrace1_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace1
    name: "ws2812@terrace1_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace2/value/voltage
    name: "ws2812@terrace2_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'
    # unit_of_measurement: "mV"
    # value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace2/value/voltage
    name: "ws2812@terrace2_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace2
    name: "ws2812@terrace2_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/light/ws2812/terrace2
    name: "ws2812@terrace2_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------
  - platform: mqtt
    state_topic: nodes@home/sensor/ttp223/bedroom/value/voltage
    name: "ttp223@bedroom_voltage"
    qos: 0
    unit_of_measurement: "V"
    value_template: '{{ value_json.value | multiply  ( 0.001 ) | round ( 1 ) }}'
    # unit_of_measurement: "mV"
    # value_template: '{{ value_json.value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ttp223/bedroom/value/voltage
    name: "ttp223@bedroom_lastvoltage"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ttp223/bedroom
    name: "ttp223@bedroom_version"
    qos: 0
    value_template: '{{ value }}'

  - platform: mqtt
    state_topic: nodes@home/sensor/ttp223/bedroom
    name: "ttp223@bedroom_lastboot"
    qos: 0
    value_template: '{{ as_timestamp ( now () ) | timestamp_custom ( "%d.%m.%Y %H:%M:%S", true ) }}'

#------------------------------------------------------------------------------

  # https://community.home-assistant.io/t/recorder-purge-function/17154/11
  - platform: command_line
    name: log_db_file_size
    command: "du -m /home/homeassistant/.homeassistant/home-assistant_v2.db | cut -f1"
    unit_of_measurement: 'MB'
    value_template: '{{ value | int - 1 }}'

#------------------------------------------------------------------------------

  # CPU temperature
  # https://community.home-assistant.io/t/displaying-cpu-temperature-within-home-assistant/8641/11
  - platform: command_line
    name: cpu_temp
    command: "cat /sys/class/thermal/thermal_zone0/temp"
    unit_of_measurement: "°C"
    value_template: '{{ (value | multiply(0.001)) | round(1) }}'

#------------------------------------------------------------------------------